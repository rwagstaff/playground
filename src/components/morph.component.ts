import {gsap} from "gsap";

const template = document.createElement('template');
template.innerHTML = `
<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="1210.000000pt" height="1280.000000pt" viewBox="0 0 1210.000000 1280.000000" preserveAspectRatio="xMidYMid meet">
    <!-- Splat path (hidden) and Circle -->
    <g transform="translate(0.000000,1201.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
        <!-- Splat path (hidden) -->
        <path id="splat" d="M4374 11719 c-59 -17 -128 -72 -161 -128 -61 -101 -83 -218 -83 -436 0 -254 43 -558 170 -1210 162 -829 210 -1158 210 -1440 0 -199 -30 -378 -81 -477 -34 -67 -113 -142 -180 -172 -110 -50 -242 -37 -406 39 -212 99 -420 265 -862 685 -507 482 -670 618 -852 709 -127 64 -211 80 -293 57 -72 -21 -132 -74 -176 -158 -106 -198 0 -415 332 -681 121 -97 267 -199 628 -439 527 -350 733 -523 858 -717 168 -262 92 -533 -186 -663 -208 -98 -386 -118 -1060 -118 -528 0 -709 -9 -862 -42 -242 -52 -360 -164 -360 -344 0 -188 117 -335 353 -444 206 -94 432 -146 1057 -245 528 -83 716 -122 933 -192 240 -77 397 -171 499 -298 139 -171 113 -344 -82 -548 -191 -201 -378 -328 -1094 -739 -537 -309 -723 -432 -873 -578 -154 -150 -194 -258 -139 -375 62 -134 227 -209 405 -184 274 38 559 197 1265 703 623 447 846 586 1101 685 256 100 448 90 580 -31 121 -110 165 -245 165 -499 0 -247 -36 -454 -180 -1023 -48 -193 -104 -423 -124 -511 -106 -477 -81 -727 81 -806 41 -20 63 -24 148 -24 94 0 105 2 170 34 125 62 259 220 364 430 96 189 174 391 346 886 228 657 377 968 555 1159 157 167 339 228 537 178 291 -74 541 -255 1111 -803 522 -502 689 -650 884 -779 274 -182 488 -218 649 -108 145 99 155 273 33 557 -88 205 -221 422 -612 995 -301 440 -436 657 -537 861 -92 187 -115 249 -141 375 -72 356 185 542 565 408 212 -75 383 -180 984 -607 477 -338 710 -446 866 -401 81 23 145 95 175 199 21 71 20 116 -2 189 -43 137 -178 281 -412 437 -179 120 -309 190 -905 487 -553 277 -671 339 -829 435 -229 139 -411 292 -503 420 -148 208 -117 421 85 573 200 150 503 253 1172 400 502 110 560 123 707 161 368 95 603 207 682 325 54 82 54 162 2 269 -96 195 -346 288 -736 271 -181 -7 -322 -23 -730 -81 -589 -84 -763 -100 -980 -92 -404 16 -637 149 -695 396 -17 72 -8 225 20 326 62 228 173 444 510 990 335 543 433 730 486 934 59 228 6 380 -163 463 -86 42 -162 44 -247 5 -77 -36 -201 -161 -284 -287 -75 -115 -222 -402 -367 -719 -230 -503 -323 -685 -450 -876 -132 -199 -248 -315 -380 -383 -276 -140 -562 7 -902 465 -141 189 -266 390 -586 945 -364 629 -515 849 -705 1029 -141 133 -251 189 -372 188 -36 -1 -79 -5 -96 -10z"
              fill="red" visibility="hidden"/>
        
        <!-- Circle in the middle with radius 1000 units -->
        <path id="circle" d="M5050 5005 a1000 1000 0 1 0 2000 0 1000 1000 0 1 0 -2000 0z" fill="red" stroke="none"/>
    </g>

    <!-- Text "Touch to Start" -->
    <text id="text" x="605" y="700" text-anchor="middle" font-size="80" font-family="Arial, sans-serif" font-weight="bold" fill="red" style="mix-blend-mode: difference;">
        Touch to Start
    </text>
</svg>
`;

export class MorphComponent extends HTMLElement {
    connectedCallback() {
        this.attachShadow({mode: 'open'});
        this.shadowRoot.appendChild(template.content.cloneNode(true));

        const circle = this.shadowRoot.querySelector("#circle");
        const target = this.shadowRoot.querySelector("#splat");


        circle.addEventListener("click", () => {
            // GSAP animation for morphing
            gsap.to(circle, {
                ease: 'power4.out',
                duration: 1,
                morphSVG: target,
            } as any);

        });

    }
}